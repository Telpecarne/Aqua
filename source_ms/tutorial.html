

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tutorials &mdash; Aqua 0.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Aqua 0.1 documentation" href="../index.html" />
    <link rel="next" title="Kinetic Analysis" href="../source_kl/kinetic_analysis.html" />
    <link rel="prev" title="Functions" href="functions.html" /> 
  </head>
  <body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../index.html"><img src="../_static/logo.gif" border="0" alt="py4sci"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../source_kl/kinetic_analysis.html" title="Kinetic Analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="functions.html" title="Functions"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.gif" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorials</a><ul>
<li><a class="reference internal" href="#loading-writting-the-topology">Loading/Writting the topology</a><ul>
<li><a class="reference internal" href="#loading">Loading</a></li>
<li><a class="reference internal" href="#navigating">Navigating</a></li>
<li><a class="reference internal" href="#writting">Writting</a></li>
</ul>
</li>
<li><a class="reference internal" href="#loading-writting-a-md-trajectory">Loading/Writting a MD trajectory</a><ul>
<li><a class="reference internal" href="#id1">Loading</a></li>
<li><a class="reference internal" href="#converting-a-trajectory-into-other-format">Converting a trajectory into other format</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-make-atoms-selections">How to make atoms selections</a></li>
<li><a class="reference internal" href="#dihedral-angles">Dihedral Angles</a><ul>
<li><a class="reference internal" href="#ramachandran-map">Ramachandran Map</a></li>
<li><a class="reference internal" href="#computing-any-dihedral-angle">Computing any dihedral angle</a></li>
</ul>
</li>
<li><a class="reference internal" href="#computing-distances">Computing distances</a><ul>
<li><a class="reference internal" href="#neighbors-and-ranked-contacts">Neighbors and Ranked contacts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#contact-maps">Contact Maps</a></li>
<li><a class="reference internal" href="#radial-distribution-funcions">Radial Distribution Funcions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="functions.html"
                        title="previous chapter">Functions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../source_kl/kinetic_analysis.html"
                        title="next chapter">Kinetic Analysis</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/source_ms/tutorial.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tutorials">
<h1>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this headline">¶</a></h1>
<p>First of all, lets load Aqua in our script or in a ipython session:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">aqua</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>Some basic notions on python will be assumed along this tutorial. If
you just landed here without any idea on python, have a look to a
Python manual or tutorial before.</p>
<p>Some files are required to follow the tutorials:</p>
<ul class="simple">
<li>Met-Enkephalin (<a class="reference external" href="http://www.rcsb.org/pdb/explore.do?structureId=1PLW">PDB: 1PLW</a> ):
<a class="reference download internal" href="../_downloads/metenk.pdb"><tt class="xref download docutils literal"><span class="pre">metenk.pdb</span></tt></a> and
<a class="reference download internal" href="../_downloads/traj_metenk.xtc"><tt class="xref download docutils literal"><span class="pre">traj_metenk.xtc</span></tt></a></li>
<li>Catabolite Activator Protein (<a class="reference external" href="http://www.rcsb.org/pdb/explore.do?structureId=2WC2">PDB: 2WC2</a> ):
<a class="reference download internal" href="../_downloads/metenk.pdb"><tt class="xref download docutils literal"><span class="pre">2WC2.pdb</span></tt></a>.</li>
</ul>
<hr class="docutils" />
<div class="section" id="loading-writting-the-topology">
<h2>Loading/Writting the topology<a class="headerlink" href="#loading-writting-the-topology" title="Permalink to this headline">¶</a></h2>
<div class="section" id="loading">
<h3>Loading<a class="headerlink" href="#loading" title="Permalink to this headline">¶</a></h3>
<p>A system can be downloaded from the Protein Data Bank.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [2]: </span><span class="n">mol_test</span><span class="o">=</span><span class="n">msystem</span><span class="p">(</span><span class="n">download</span><span class="o">=</span><span class="s">&#39;2WC2&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># File saved as 2WC2.pdb</span>
<span class="c"># System created from the file 2WC2.pdb :</span>
<span class="c"># 6704  atoms</span>
<span class="c"># 418  residues</span>
<span class="c"># 2  chains</span>
<span class="c"># 0  waters</span>
<span class="c"># 0  ions</span>
<span class="c"># 20  frames/models in traj 0</span>
</pre></div>
</div>
<p>Or</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [3]: </span><span class="n">mol2_test</span><span class="o">=</span><span class="n">msystem</span><span class="p">(</span><span class="s">&#39;2WC2.pdb&#39;</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">mol2_test</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="c"># System created from the file 2WC2.pdb :</span>
<span class="c"># 6704  atoms</span>
<span class="c"># 418  residues</span>
<span class="c"># 2  chains</span>
<span class="c"># 0  waters</span>
<span class="c"># 0  ions</span>
<span class="c"># 20  frames/models in traj 0</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Complete the topology of residues and terminals. Apparently
it works because the option &#8220;with_bonds=False&#8221; is by default. It needs to be watched.</p>
</div>
<p>This way the pdb file has been loaded together with the coordinates
present in the file, 20 different models in the case of 2WC2.  If the
coordinates are going to be loaded from a different file, the topology
without coordinates can be created adding the option coors=False:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [5]: </span><span class="n">mol3_test</span><span class="o">=</span><span class="n">msystem</span><span class="p">(</span><span class="s">&#39;2WC2.pdb&#39;</span><span class="p">,</span><span class="n">coors</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="c"># System created from the file 2WC2.pdb :</span>
<span class="c"># 6704  atoms</span>
<span class="c"># 418  residues</span>
<span class="c"># 2  chains</span>
<span class="c"># 0  waters</span>
<span class="c"># 0  ions</span>

<span class="gp">In [6]: </span><span class="n">mol3_test</span><span class="o">.</span><span class="n">info_trajs</span><span class="p">()</span>
<span class="c"># No coordinates</span>

<span class="gp">In [7]: </span><span class="n">mol2_test</span><span class="o">.</span><span class="n">info_trajs</span><span class="p">()</span>
<span class="c"># 20 frames/models in traj 0</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For further information on the functions and attributes used
visit: <a class="reference internal" href="msystem.html#msystem" title="msystem"><tt class="xref py py-class docutils literal"><span class="pre">msystem</span></tt></a>, <a class="reference internal" href="functions.html#msystem.info" title="msystem.info"><tt class="xref py py-meth docutils literal"><span class="pre">msystem.info()</span></tt></a>, <a class="reference internal" href="functions.html#msystem.info_trajs" title="msystem.info_trajs"><tt class="xref py py-meth docutils literal"><span class="pre">msystem.info_trajs()</span></tt></a>.</p>
</div>
</div>
<div class="section" id="navigating">
<h3>Navigating<a class="headerlink" href="#navigating" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="writting">
<h3>Writting<a class="headerlink" href="#writting" title="Permalink to this headline">¶</a></h3>
<p>XXX</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="loading-writting-a-md-trajectory">
<h2>Loading/Writting a MD trajectory<a class="headerlink" href="#loading-writting-a-md-trajectory" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>Loading<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Once a topology has been created a trajectory can be loaded from
different formats: pdb, gro, xtc, trr, dcd, bin (to be deprecated).</p>
<p>It is recommended the use of dcd files, the file is unformatted and
thereby it is small and easy to handle.</p>
<p>Along this section the different ways to do it will be illustrated
using the files <a class="reference download internal" href="../_downloads/GSGS.pdb"><tt class="xref download docutils literal"><span class="pre">GSGS.pdb</span></tt></a>
and <a class="reference download internal" href="../_downloads/GSGS.dcd"><tt class="xref download docutils literal"><span class="pre">GSGS.dcd</span></tt></a>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [2]: </span><span class="n">GSGS</span><span class="o">=</span><span class="n">msystem</span><span class="p">(</span><span class="s">&#39;GSGS.pdb&#39;</span><span class="p">)</span>
<span class="c"># System created from the file GSGS.pdb :</span>
<span class="c"># 4723  atoms</span>
<span class="c"># 1568  residues</span>
<span class="c"># 3  chains</span>
<span class="c"># 1560  waters</span>
<span class="c"># 4  ions</span>
<span class="c"># 1  frames/models in traj 0</span>

<span class="gp">In [3]: </span><span class="n">GSGS</span><span class="o">.</span><span class="n">delete_traj</span><span class="p">()</span>

<span class="gp">In [4]: </span><span class="n">GSGS</span><span class="o">.</span><span class="n">info_trajs</span><span class="p">()</span>
<span class="c"># No coordinates</span>

<span class="gp">In [5]: </span><span class="n">GSGS</span><span class="o">.</span><span class="n">msystem</span><span class="p">(</span><span class="s">&#39;GSGS.dcd&#39;</span><span class="p">,</span><span class="s">&#39;ALL&#39;</span><span class="p">)</span>
<span class="c"># 10 frames/models loaded.</span>
</pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [2]: </span><span class="n">GSGS</span><span class="o">=</span><span class="n">msystem</span><span class="p">(</span><span class="s">&#39;GSGS.pdb&#39;</span><span class="p">,</span><span class="n">coors</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">GSGS</span><span class="o">.</span><span class="n">load_traj</span><span class="p">(</span><span class="s">&#39;GSGS.dcd&#39;</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s">&#39;ALL&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">GSGS</span><span class="o">.</span><span class="n">info</span><span class="p">();</span> <span class="n">GSGS</span><span class="o">.</span><span class="n">info_trajs</span><span class="p">()</span>
<span class="c"># System created from the file GSGS.pdb :</span>
<span class="c"># 4723  atoms</span>
<span class="c"># 1568  residues</span>
<span class="c"># 3  chains</span>
<span class="c"># 1560  waters</span>
<span class="c"># 4  ions</span>
<span class="c"># 10  frames/models in traj 0</span>
</pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [2]: </span><span class="n">GSGS</span><span class="o">=</span><span class="n">msystem</span><span class="p">(</span><span class="s">&#39;GSGS.pdb&#39;</span><span class="p">,</span><span class="n">coors</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">GSGS</span><span class="o">.</span><span class="n">load_traj</span><span class="p">(</span><span class="s">&#39;GSGS.dcd&#39;</span><span class="p">)</span>
<span class="c"># 0 frames/models in traj 0</span>

<span class="gp">In [4]: </span><span class="k">print</span> <span class="n">GSGS</span><span class="o">.</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">GSGS</span><span class="o">.</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">GSGS</span><span class="o">.</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">io_opened</span><span class="p">,</span> <span class="n">GSGS</span><span class="o">.</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">io_end</span>
<span class="go">GSGS.dcd dcd True False</span>

<span class="gp">In [5]: </span><span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
<span class="go">  ....:     GSGS.traj[0].upload_frame()</span>
<span class="go">  ....:     if GSGS.traj[0].io_end: break</span>
<span class="go">  ....:</span>

<span class="c"># End of file</span>
<span class="gp">In [6]: </span><span class="n">GSGS</span><span class="o">.</span><span class="n">info_trajs</span><span class="p">()</span>
<span class="c"># 10 frames/models in traj 0</span>
</pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [2]: </span><span class="n">GSGS</span><span class="o">=</span><span class="n">msystem</span><span class="p">(</span><span class="s">&#39;GSGS.pdb&#39;</span><span class="p">,</span><span class="n">coors</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">GSGS</span><span class="o">.</span><span class="n">load_traj</span><span class="p">(</span><span class="s">&#39;GSGS.dcd&#39;</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c"># Or frame=&#39;Next&#39;</span>
<span class="c"># 1 frames/models in traj 0</span>

<span class="gp">In [4]: </span><span class="k">while</span> <span class="n">GSGS</span><span class="o">.</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">io_opened</span><span class="p">:</span>
<span class="go">   ...:     print GSGS.traj[0].frame[0].coors[0]</span>
<span class="go">   ...:     GSGS.traj[0].reload_frame()</span>
<span class="go">   ...:</span>
<span class="go">[ -7.26851273  -8.12112617  10.57811832]</span>
<span class="go">[ -5.16595078  -9.8920269   12.24640751]</span>
<span class="go">[ -6.12880325  -9.20014763  15.28322697]</span>
<span class="go">[ -4.90646744  -8.31535339  12.97708988]</span>
<span class="go">[ -5.04781723  -9.68705559  14.15655327]</span>
<span class="go">[ -5.95707321  -8.45479965  17.51550102]</span>
<span class="go">[ -4.45994186 -10.63479614  16.19140053]</span>
<span class="go">[ -6.01659775 -13.60509872  16.98220253]</span>
<span class="go">[ -4.40946579 -13.10482597  17.12298393]</span>
<span class="go">[ -5.01924515 -13.77911949  15.64630699]</span>

<span class="c"># End of file</span>
<span class="gp">In [5]: </span><span class="n">GSGS</span><span class="o">.</span><span class="n">info_trajs</span><span class="p">()</span>
<span class="c"># 1 frames/models in traj 0</span>
</pre></div>
</div>
</div>
<div class="section" id="converting-a-trajectory-into-other-format">
<span id="ms-tut-convert-traj"></span><h3>Converting a trajectory into other format<a class="headerlink" href="#converting-a-trajectory-into-other-format" title="Permalink to this headline">¶</a></h3>
<p>Right now the output format is only dcd.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [2]: </span><span class="n">metenk</span><span class="o">=</span><span class="n">msystem</span><span class="p">(</span><span class="s">&#39;metenk.pdb&#39;</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">metenk</span><span class="o">.</span><span class="n">load_traj</span><span class="p">(</span><span class="s">&#39;traj_metenk.xtc&#39;</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">metenk</span><span class="o">.</span><span class="n">info_trajs</span><span class="p">()</span>
<span class="c"># 0 frames/models in traj 0</span>

<span class="gp">In [5]: </span><span class="n">metenk</span><span class="o">.</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;traj_metenk.dcd&#39;</span><span class="p">,</span><span class="n">action</span><span class="o">=</span><span class="s">&#39;Open&#39;</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
<span class="go">   ...:     metenk.traj[0].reload_frame()</span>
<span class="go">   ...:     if metenk.traj[0].io_end:</span>
<span class="go">   ...:        metenk.traj[0].write(action=&#39;Close&#39;)</span>
<span class="go">   ...:        break</span>
<span class="go">   ...:     metenk.traj[0].write(frame=0)</span>
</pre></div>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="msystem.html#msystem" title="msystem"><tt class="xref py py-class docutils literal"><span class="pre">msystem</span></tt></a>, <a class="reference internal" href="coors.html#traj" title="traj"><tt class="xref py py-class docutils literal"><span class="pre">traj</span></tt></a>, <a class="reference internal" href="functions.html#msystem.load_traj" title="msystem.load_traj"><tt class="xref py py-meth docutils literal"><span class="pre">msystem.load_traj()</span></tt></a>, <a class="reference internal" href="functions.html#msystem.info_trajs" title="msystem.info_trajs"><tt class="xref py py-meth docutils literal"><span class="pre">msystem.info_trajs()</span></tt></a>, <a class="reference internal" href="functions.html#traj.reload_frame" title="traj.reload_frame"><tt class="xref py py-meth docutils literal"><span class="pre">traj.reload_frame()</span></tt></a>, <a class="reference internal" href="functions.html#traj.write" title="traj.write"><tt class="xref py py-meth docutils literal"><span class="pre">traj.write()</span></tt></a></p>
</div>
</div>
</div>
<div class="section" id="how-to-make-atoms-selections">
<span id="ms-tut-selections"></span><h2>How to make atoms selections<a class="headerlink" href="#how-to-make-atoms-selections" title="Permalink to this headline">¶</a></h2>
<p>The syntax is close to the aqua syntax.
There are few special key words.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [2]: </span><span class="n">metenk</span><span class="o">=</span><span class="n">msystem</span><span class="p">(</span><span class="s">&#39;metenk.pdb&#39;</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">list1</span><span class="o">=</span><span class="n">metenk</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="s">&#39;backbone&#39;</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">list2</span><span class="o">=</span><span class="n">metenk</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="s">&#39;atom.name N CA C O&#39;</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="k">print</span> <span class="n">list1</span><span class="p">;</span> <span class="k">print</span> <span class="n">list2</span>
<span class="go">[0, 4, 21, 22, 23, 25, 28, 29, 30, 32, 35, 36, 37, 39, 55, 56, 57, 59, 72]</span>
<span class="go">[0, 4, 21, 22, 23, 25, 28, 29, 30, 32, 35, 36, 37, 39, 55, 56, 57, 59, 72]</span>

<span class="gp">In [5]: </span><span class="n">metenk</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="s">&#39;resid.name PHE and backbone&#39;</span><span class="p">)</span>
<span class="gr">Out[5]: </span><span class="p">[</span><span class="mi">37</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">]</span>

<span class="gp">In [6]: </span><span class="n">metenk</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="s">&#39;chain.name A and atom.donor&#39;</span><span class="p">)</span>
<span class="gr">Out[6]: </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">57</span><span class="p">]</span>

<span class="gp">In [7]: </span><span class="n">metenk</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="s">&#39;(atom.resid.name GLY and not atom.name N CA C O H) or (atom.name O1)&#39;</span><span class="p">)</span>
<span class="gr">Out[7]: </span><span class="p">[</span><span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">73</span><span class="p">]</span>
</pre></div>
</div>
<p>We can also make use of the expression &#8216;within X of&#8217;, X is a float number indicating a distance threshold.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [8]: </span><span class="n">metenk</span><span class="o">.</span><span class="n">load_traj</span><span class="p">(</span><span class="s">&#39;traj_metenk.xtc&#39;</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s">&#39;ALL&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [9]: </span><span class="n">list0</span><span class="o">=</span><span class="n">metenk</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="s">&#39;atom.name OW within 3.0 of resid.type Protein&#39;</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">metenk</span><span class="o">.</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">num_frames</span><span class="p">):</span>
<span class="go">   ....:     print len(list0[ii]), &#39;waters below 3.0 in frame&#39;, ii</span>
<span class="go">   ....:</span>
<span class="go">25 waters below 3.0 in frame 0</span>
<span class="go">30 waters below 3.0 in frame 1</span>
<span class="go">28 waters below 3.0 in frame 2</span>
<span class="go">...</span>

<span class="gp">In [11]: </span><span class="n">list0</span><span class="o">=</span><span class="n">metenk</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="s">&#39;(atom.name CA and not resid.name TYR) within 6.0 of (atom.name CA and resid.name TYR)&#39;</span><span class="p">)</span>

<span class="gp">In [12]: </span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">metenk</span><span class="o">.</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">num_frames</span><span class="p">):</span>
<span class="go">   ....:     print &#39;At time:&#39;, metenk.traj[0].frame[ii].time</span>
<span class="go">   ....:     for jj in list0[ii]:</span>
<span class="go">   ....:         print &#39;   &#39;,metenk.atom[jj].name+&#39;-&#39;+str(metenk.atom[jj].pdb_index),&#39;within 6.0 of CA-5&#39;</span>
<span class="go">At time: 0.0</span>
<span class="go">   CA-26 within 6.0 of CA-5</span>
<span class="go">At time: 10.0</span>
<span class="go">   CA-26 within 6.0 of CA-5</span>
<span class="go">At time: 20.0</span>
<span class="go">   CA-26 within 6.0 of CA-5</span>
<span class="go">   CA-33 within 6.0 of CA-5</span>
<span class="go">...</span>
</pre></div>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="functions.html#msystem.selection" title="msystem.selection"><tt class="xref py py-meth docutils literal"><span class="pre">msystem.selection()</span></tt></a></p>
</div>
</div>
<div class="section" id="dihedral-angles">
<h2>Dihedral Angles<a class="headerlink" href="#dihedral-angles" title="Permalink to this headline">¶</a></h2>
<div class="section" id="ramachandran-map">
<span id="ms-tut-rama-map"></span><h3>Ramachandran Map<a class="headerlink" href="#ramachandran-map" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [2]: </span><span class="n">metenk</span><span class="o">=</span><span class="n">msystem</span><span class="p">(</span><span class="s">&#39;metenk.pdb&#39;</span><span class="p">,</span><span class="n">coors</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">angs</span><span class="p">,</span><span class="n">keys</span><span class="o">=</span><span class="n">metenk</span><span class="o">.</span><span class="n">ramachandran_map</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="k">print</span> <span class="n">keys</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s">&#39;=&#39;</span><span class="p">,</span><span class="n">angs</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s">&#39;  &#39;</span><span class="p">,</span> <span class="n">keys</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="s">&#39;=&#39;</span><span class="p">,</span><span class="n">angs</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="go">Phi 3 = -1.92163955875    Psi 3 = -0.642196409677</span>

<span class="gp">In [5]: </span><span class="k">print</span> <span class="n">metenk</span><span class="o">.</span><span class="n">ramachandran_map</span><span class="p">(</span><span class="n">resid</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[-1.92163956 -0.64219641]</span>

<span class="gp">In [6]: </span><span class="n">dangs</span><span class="p">,</span><span class="n">dkeys</span><span class="o">=</span><span class="n">metenk</span><span class="o">.</span><span class="n">ramachandran_map</span><span class="p">(</span><span class="n">resid</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">pdb_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="k">print</span> <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s">&#39;=&#39;</span><span class="p">,</span><span class="n">angs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s">&#39;  &#39;</span><span class="p">,</span> <span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s">&#39;=&#39;</span><span class="p">,</span><span class="n">angs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">Phi 4 = -1.92163955875    Psi 4 = -0.642196409677</span>
</pre></div>
</div>
<p>In case of having different frames to analyse coming from a trajectory:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [8]: </span><span class="n">metenk</span><span class="o">.</span><span class="n">info_trajs</span><span class="p">()</span>
<span class="c"># 1 frames/models in traj 0</span>

<span class="gp">In [9]: </span><span class="k">print</span> <span class="n">metenk</span><span class="o">.</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
<span class="go">metenk.pdb</span>

<span class="gp">In [10]: </span><span class="n">metenk</span><span class="o">.</span><span class="n">delete_traj</span><span class="p">()</span>

<span class="gp">In [11]: </span><span class="n">metenk</span><span class="o">.</span><span class="n">info_trajs</span><span class="p">()</span>
<span class="c"># No coordinates</span>

<span class="gp">In [12]: </span><span class="n">metenk</span><span class="o">.</span><span class="n">load_traj</span><span class="p">(</span><span class="s">&#39;traj_metenk.xtc&#39;</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s">&#39;ALL&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># 21 frames/models in traj 0</span>

<span class="gp">In [13]: </span><span class="n">angs</span><span class="p">,</span><span class="n">keys</span><span class="o">=</span><span class="n">metenk</span><span class="o">.</span><span class="n">ramachandran_map</span><span class="p">(</span><span class="n">resid</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="n">frame</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="n">pdb_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">In [14]: </span><span class="k">print</span> <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="s">&#39;(step=[0,10,20]) =&#39;</span><span class="p">,</span><span class="n">angs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="go">Psi 3 (step=[0,10,20]) = [ 0.87594459  0.64741795  1.22817325]</span>

<span class="gp">In [15]: </span><span class="n">angs</span><span class="o">=</span><span class="n">metenk</span><span class="o">.</span><span class="n">ramachandran_map</span><span class="p">(</span><span class="n">resid</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s">&#39;ALL&#39;</span><span class="p">)</span>

<span class="gp">In [16]: </span><span class="n">idres2</span><span class="o">=</span><span class="n">metenk</span><span class="o">.</span><span class="n">resid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">metenk</span><span class="o">.</span><span class="n">resid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">pdb_index</span><span class="p">)</span>

<span class="gp">In [17]: </span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">metenk</span><span class="o">.</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">num_frames</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
<span class="go">   ....:     print idres2,&#39;| t=&#39;, metenk.traj[0].frame[ii].time, &#39;| [phi,psi]=&#39;, angs[ii,:]</span>
<span class="go">GLY3 | t= 0.0 | [phi,psi]= [ 2.01215258  0.87594459]</span>
<span class="go">GLY3 | t= 100.0 | [phi,psi]= [ 1.90493036  0.64741795]</span>
<span class="go">GLY3 | t= 200.0 | [phi,psi]= [ 1.9432302   1.22817325]</span>
</pre></div>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="msystem.html#msystem" title="msystem"><tt class="xref py py-class docutils literal"><span class="pre">msystem</span></tt></a>, <a class="reference internal" href="coors.html#traj" title="traj"><tt class="xref py py-class docutils literal"><span class="pre">traj</span></tt></a>, <a class="reference internal" href="msystem.html#resid" title="resid"><tt class="xref py py-class docutils literal"><span class="pre">resid</span></tt></a>, <a class="reference internal" href="functions.html#msystem.load_traj" title="msystem.load_traj"><tt class="xref py py-meth docutils literal"><span class="pre">msystem.load_traj()</span></tt></a>, <a class="reference internal" href="functions.html#msystem.info_trajs" title="msystem.info_trajs"><tt class="xref py py-meth docutils literal"><span class="pre">msystem.info_trajs()</span></tt></a>, <a class="reference internal" href="functions.html#msystem.delete_traj" title="msystem.delete_traj"><tt class="xref py py-meth docutils literal"><span class="pre">msystem.delete_traj()</span></tt></a>, <a class="reference internal" href="functions.html#msystem.ramachandran_map" title="msystem.ramachandran_map"><tt class="xref py py-meth docutils literal"><span class="pre">msystem.ramachandran_map()</span></tt></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Depending on how this method is used, it can result with a
low performance. Check the next section <a class="reference internal" href="#ms-tut-any-dihang"><em>Computing any dihedral angle</em></a> for a better performance.</p>
</div>
</div>
<div class="section" id="computing-any-dihedral-angle">
<span id="ms-tut-any-dihang"></span><h3>Computing any dihedral angle<a class="headerlink" href="#computing-any-dihedral-angle" title="Permalink to this headline">¶</a></h3>
<p>A dihedral angle can be computed with a set of 4 atoms. This way, the
computation of dihedral angles goes beyond the analysis done with
<a class="reference internal" href="functions.html#msystem.ramachandran_map" title="msystem.ramachandran_map"><tt class="xref py py-meth docutils literal"><span class="pre">msystem.ramachandran_map()</span></tt></a>.</p>
<p>There is a method to extract sets of 4 atoms corresponding to
consecutive covalently bound chains of atoms:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [2]: </span><span class="n">metenk</span><span class="o">=</span><span class="n">msystem</span><span class="p">(</span><span class="s">&#39;metenk.pdb&#39;</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">phi_3</span><span class="o">=</span><span class="n">metenk</span><span class="o">.</span><span class="n">selection_covalent_chains</span><span class="p">(</span><span class="n">chain</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;C&#39;</span><span class="p">,</span><span class="s">&#39;N&#39;</span><span class="p">,</span><span class="s">&#39;CA&#39;</span><span class="p">,</span><span class="s">&#39;C&#39;</span><span class="p">],</span><span class="n">select</span><span class="o">=</span><span class="s">&#39;resid.index 2 3&#39;</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">psi_3</span><span class="o">=</span><span class="n">metenk</span><span class="o">.</span><span class="n">selection_covalent_chains</span><span class="p">(</span><span class="n">chain</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;N&#39;</span><span class="p">,</span><span class="s">&#39;CA&#39;</span><span class="p">,</span><span class="s">&#39;C&#39;</span><span class="p">,</span><span class="s">&#39;N&#39;</span><span class="p">],</span><span class="n">select</span><span class="o">=</span><span class="s">&#39;resid.index 3 4&#39;</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">xi1_3</span><span class="o">=</span><span class="n">metenk</span><span class="o">.</span><span class="n">selection_covalent_chains</span><span class="p">(</span><span class="n">chain</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;N&#39;</span><span class="p">,</span><span class="s">&#39;CA&#39;</span><span class="p">,</span><span class="s">&#39;CB&#39;</span><span class="p">,</span><span class="s">&#39;CG&#39;</span><span class="p">],</span><span class="n">select</span><span class="o">=</span><span class="s">&#39;resid.index 3&#39;</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">omegas</span><span class="o">=</span><span class="n">metenk</span><span class="o">.</span><span class="n">selection_covalent_chains</span><span class="p">(</span><span class="n">chain</span><span class="o">=</span><span class="p">[[</span><span class="s">&#39;CA&#39;</span><span class="p">,</span><span class="s">&#39;CH3&#39;</span><span class="p">],</span><span class="s">&#39;C&#39;</span><span class="p">,</span><span class="s">&#39;N&#39;</span><span class="p">,[</span><span class="s">&#39;CA&#39;</span><span class="p">,</span><span class="s">&#39;CH3&#39;</span><span class="p">]])</span>

<span class="gp">In [6]: </span><span class="k">print</span> <span class="n">omegas</span>
<span class="go">[[4, 21, 23, 25], [25, 28, 30, 32], [32, 35, 37, 39], [39, 55, 57, 59]]</span>
</pre></div>
</div>
<p>With this sets of 4-tuples the dihedral angles can be computed as:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [7]: </span><span class="n">metenk</span><span class="o">.</span><span class="n">load_traj</span><span class="p">(</span><span class="s">&#39;traj_metenk.xtc&#39;</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s">&#39;ALL&#39;</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="n">angs_phi_3</span><span class="o">=</span><span class="n">metenk</span><span class="o">.</span><span class="n">dihedral_angle</span><span class="p">(</span><span class="n">phi_3</span><span class="p">)</span>

<span class="gp">In [9]: </span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">metenk</span><span class="o">.</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">num_frames</span><span class="p">):</span>
<span class="go">  ....:     print &#39;Phi 3 (step=&#39;+str(ii)+&#39;)&#39;, angs_phi_3[ii]</span>
<span class="go">  ....:</span>
<span class="go">Phi 3 (step=0) -1.92022469777</span>
<span class="go">Phi 3 (step=1) -1.59101737012</span>
<span class="go">Phi 3 (step=2) -1.61015325568</span>
<span class="go">Phi 3 (step=3) -1.99394603011</span>
<span class="go">...</span>

<span class="gp">In [10]: </span><span class="k">print</span> <span class="n">metenk</span><span class="o">.</span><span class="n">dihedral_angle</span><span class="p">(</span><span class="n">covalent_chain</span><span class="o">=</span><span class="n">psi_3</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">-0.23084216</span>

<span class="gp">In [11]: </span><span class="n">ang_omegas</span><span class="o">=</span><span class="n">metenk</span><span class="o">.</span><span class="n">dihedral_angle</span><span class="p">(</span><span class="n">covalent_chain</span><span class="o">=</span><span class="n">omegas</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span>

<span class="gp">In [12]: </span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">omegas</span><span class="p">)):</span>
<span class="go">   ....:     print &#39;omega_&#39;+str(ii+1)+&#39; (step=[0,10,20])= &#39;,str(ang_omegas[:,ii])</span>
<span class="go">   ....:</span>
<span class="go">omega_1 (step=[0,10,20])=  [ 3.13688483 -3.08321194 -3.07475646]</span>
<span class="go">omega_2 (step=[0,10,20])=  [ 3.1379404   3.08377778 -3.11113559]</span>
<span class="go">omega_3 (step=[0,10,20])=  [ 3.13383903 -3.11193193 -3.0400114 ]</span>
<span class="go">omega_4 (step=[0,10,20])=  [ 3.13693669 -3.0892444  -3.03312968]</span>
</pre></div>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="msystem.html#msystem" title="msystem"><tt class="xref py py-class docutils literal"><span class="pre">msystem</span></tt></a>, <a class="reference internal" href="coors.html#traj" title="traj"><tt class="xref py py-class docutils literal"><span class="pre">traj</span></tt></a>, <a class="reference internal" href="functions.html#msystem.load_traj" title="msystem.load_traj"><tt class="xref py py-meth docutils literal"><span class="pre">msystem.load_traj()</span></tt></a>, <a class="reference internal" href="functions.html#msystem.selection_covalent_chains" title="msystem.selection_covalent_chains"><tt class="xref py py-meth docutils literal"><span class="pre">msystem.selection_covalent_chains()</span></tt></a>, <a class="reference internal" href="functions.html#msystem.dihedral_angle" title="msystem.dihedral_angle"><tt class="xref py py-meth docutils literal"><span class="pre">msystem.dihedral_angle()</span></tt></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the angles phi and psi are the goal of the analysis, the method <a class="reference internal" href="functions.html#msystem.ramachandran_map" title="msystem.ramachandran_map"><tt class="xref py py-meth docutils literal"><span class="pre">msystem.ramachandran_map()</span></tt></a> can be another tool to be considered.</p>
</div>
</div>
</div>
<div class="section" id="computing-distances">
<h2>Computing distances<a class="headerlink" href="#computing-distances" title="Permalink to this headline">¶</a></h2>
<p>The distance between a set of n1 atoms, list1, and a set of n2 atoms,
list2.  If only one frame is analysed the output is a 2D matrix
[n1,n2].  This way the distance between the i-th atom in list1 and
j-th in list2 correspond to output[i,j].</p>
<p>If more than one frame is analysed the output is a 3D matrix
[n1,n2,number_frames] (following the previous notation).</p>
<p>It is faster if len(list1)&lt;len(list2).</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [2]: </span><span class="n">GSGS</span><span class="o">=</span><span class="n">molecule</span><span class="p">(</span><span class="s">&#39;GSGS.pdb&#39;</span><span class="p">,</span><span class="n">coors</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">GSGS</span><span class="o">.</span><span class="n">load_traj</span><span class="p">(</span><span class="s">&#39;GSGS.dcd&#39;</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s">&#39;ALL&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">list1</span><span class="o">=</span><span class="n">GSGS</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="s">&#39;atom.resid.type Protein&#39;</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">list2</span><span class="o">=</span><span class="n">GSGS</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="s">&#39;atom.resid.type Water and atom.type O&#39;</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">result</span><span class="o">=</span><span class="n">GSGS</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span><span class="n">list2</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">GSGS</span><span class="o">.</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">num_frames</span><span class="p">):</span>
<span class="go">   ....:    print &#39;The distance between atoms index&#39;,list1[1],&#39;and&#39;,list2[3],&#39;is&#39;,result[1,3][ii],&#39;in frame&#39;,ii</span>
<span class="go">   ....:</span>
<span class="go">The distance between atoms index 1 and 48 is 24.8435076017 in frame 0</span>
<span class="go">The distance between atoms index 1 and 48 is 23.6529328175 in frame 1</span>
<span class="go">The distance between atoms index 1 and 48 is 24.3209230117 in frame 2</span>
<span class="go">The distance between atoms index 1 and 48 is 21.5236312048 in frame 3</span>
<span class="go">The distance between atoms index 1 and 48 is 25.2685193116 in frame 4</span>
<span class="go">The distance between atoms index 1 and 48 is 28.2550958504 in frame 5</span>
<span class="go">The distance between atoms index 1 and 48 is 26.1290587977 in frame 6</span>
<span class="go">The distance between atoms index 1 and 48 is 20.9157208891 in frame 7</span>
<span class="go">The distance between atoms index 1 and 48 is 21.6473615840 in frame 8</span>
<span class="go">The distance between atoms index 1 and 48 is 18.5862638499 in frame 9</span>
</pre></div>
</div>
<div class="section" id="neighbors-and-ranked-contacts">
<h3>Neighbors and Ranked contacts<a class="headerlink" href="#neighbors-and-ranked-contacts" title="Permalink to this headline">¶</a></h3>
<p>The function neighbs can help with its different options to approach this problems.
Notice that the cut-off here is the limit in the ranked list of closest neighbors or a given distance.
In the former case the output can be sorted or not by distance.
If only contact map is need, maybe the following section is suitable because of its efficience.</p>
<p>Neighbors with a distance lower or equal than a certain threshold:</p>
</div>
</div>
<div class="section" id="contact-maps">
<h2>Contact Maps<a class="headerlink" href="#contact-maps" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="radial-distribution-funcions">
<h2>Radial Distribution Funcions<a class="headerlink" href="#radial-distribution-funcions" title="Permalink to this headline">¶</a></h2>
<p>The radial distribution function g_{a,b}(r) represents the radial
concentration of atoms &#8220;b&#8221; around atoms &#8220;a&#8221;, normalized by the
concentration of &#8220;b&#8221;.</p>
<p>It is more efficient (fast and no memory consumming) when the trajectorie is read frame by frame, and
not loaded at a time.
As it happens with the distance function, when len(list1)&lt;len(list2) it is faster.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Right now the function does not work properly if
setA=setB. In addition, this should be efficient including the
condition &#8220;same set&#8221; for function dists.</p>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [2]: </span><span class="n">ion</span><span class="o">=</span><span class="n">molecule</span><span class="p">(</span><span class="s">&#39;run_ion.gro&#39;</span><span class="p">,</span><span class="n">coors</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">ion</span><span class="o">.</span><span class="n">load_traj</span><span class="p">(</span><span class="s">&#39;traj.dcd&#39;</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s">&#39;ALL&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">list1</span><span class="o">=</span><span class="n">ion</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="s">&#39;atom.resid.type Ion&#39;</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">list2</span><span class="o">=</span><span class="n">ion</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="s">&#39;atom.name OW&#39;</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">rdf_xx</span><span class="p">,</span><span class="n">rdf_yy</span><span class="o">=</span><span class="n">ion</span><span class="o">.</span><span class="n">rdf</span><span class="p">(</span><span class="n">setA</span><span class="o">=</span><span class="n">list1</span><span class="p">,</span><span class="n">setB</span><span class="o">=</span><span class="n">list2</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span><span class="n">segment</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">30.0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [2]: </span><span class="n">ion</span><span class="o">=</span><span class="n">molecule</span><span class="p">(</span><span class="s">&#39;run_ion.gro&#39;</span><span class="p">,</span><span class="n">coors</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">ion</span><span class="o">.</span><span class="n">load_traj</span><span class="p">(</span><span class="s">&#39;traj.dcd&#39;</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s">&#39;Next&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">list1</span><span class="o">=</span><span class="n">ion</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="s">&#39;atom.name OW&#39;</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">list2</span><span class="o">=</span><span class="n">ion</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="s">&#39;atom.resid.type Ion&#39;</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">rdf_xx</span><span class="o">=</span><span class="n">pyn_math</span><span class="o">.</span><span class="n">binning</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span><span class="n">segment</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">30.0</span><span class="p">])</span>

<span class="gp">In [7]: </span><span class="n">rdf_yy</span><span class="o">=</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1500</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;Fortran&#39;</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="n">num_frames</span><span class="o">=</span><span class="mi">0</span>

<span class="gp">In [9]: </span><span class="k">while</span> <span class="n">ion</span><span class="o">.</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">io_opened</span><span class="p">:</span>
<span class="go">   ...:     rdf_yy+=ion.rdf(setA=list1,setB=list2,traj=0,frame=0,bins=1500,segment=[0.0,30.0])</span>
<span class="go">   ...:     num_frames+=1</span>
<span class="go">   ...:     ion.traj[0].reload_frame()</span>

<span class="c"># End of file</span>
<span class="gp">In [10]: </span><span class="n">rdf_yy</span><span class="o">=</span><span class="n">rdf_yy</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">num_frames</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../source_kl/kinetic_analysis.html" title="Kinetic Analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="functions.html" title="Functions"
             >previous</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Diego Prada-Gracia.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>